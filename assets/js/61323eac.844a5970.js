"use strict";(globalThis.webpackChunkdocs_cloud=globalThis.webpackChunkdocs_cloud||[]).push([[243],{8099:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"tutorial-basics/building-docker-image","title":"Gu\xeda de Despliegue con Docker Compose","description":"1. Ubicarse en la carpeta del proyecto","source":"@site/docs/tutorial-basics/building-docker-image.md","sourceDirName":"tutorial-basics","slug":"/tutorial-basics/building-docker-image","permalink":"/ultimoparcial/docs/tutorial-basics/building-docker-image","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"Verificaci\xf3n del Push en DockerHub","permalink":"/ultimoparcial/docs/tutorial-basics/verificacion-push-dockerhub"}}');var i=r(4848),a=r(8453);const d={sidebar_position:8},o="Gu\xeda de Despliegue con Docker Compose",c={},l=[{value:"1. Ubicarse en la carpeta del proyecto",id:"1-ubicarse-en-la-carpeta-del-proyecto",level:2},{value:"2. Estructura del proyecto",id:"2-estructura-del-proyecto",level:2},{value:"3. Archivo docker-compose.yml",id:"3-archivo-docker-composeyml",level:2},{value:"\xbfQu\xe9 hace este archivo?",id:"qu\xe9-hace-este-archivo",level:3},{value:"4. Archivo default.conf (Configuraci\xf3n de Nginx)",id:"4-archivo-defaultconf-configuraci\xf3n-de-nginx",level:2},{value:"5. Archivo de Base de Datos (data/bd.sql)",id:"5-archivo-de-base-de-datos-databdsql",level:2},{value:"Credenciales de la base de datos",id:"credenciales-de-la-base-de-datos",level:3},{value:"6. Servicio Nginx \u2014 Puertos",id:"6-servicio-nginx--puertos",level:2},{value:"7. Tabla de Puertos del Proyecto",id:"7-tabla-de-puertos-del-proyecto",level:2},{value:"8.1 docker pull imagen",id:"81-docker-pull-imagen",level:2},{value:"8.2 docker-compose up -d",id:"82-docker-compose-up--d",level:2}];function t(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"gu\xeda-de-despliegue-con-docker-compose",children:"Gu\xeda de Despliegue con Docker Compose"})}),"\n",(0,i.jsx)(n.h2,{id:"1-ubicarse-en-la-carpeta-del-proyecto",children:"1. Ubicarse en la carpeta del proyecto"}),"\n",(0,i.jsxs)(n.p,{children:["Desde PowerShell o cualquier terminal, navega hasta el directorio donde se encuentra el archivo ",(0,i.jsx)(n.code,{children:"docker-compose.yml"}),".",(0,i.jsx)(n.br,{}),"\n","Este archivo contiene la configuraci\xf3n completa de todos los servicios que se van a levantar (backend, base de datos, Nginx, phpMyAdmin, etc.)."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"2-estructura-del-proyecto",children:"2. Estructura del proyecto"}),"\n",(0,i.jsx)(n.p,{children:"La estructura esperada del proyecto es la siguiente:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\r\n/  # Carpeta ra\xedz del proyecto\r\n\u251c\u2500\u2500 data/                 # Contiene el script SQL de inicializaci\xf3n\r\n\u2502   \u2514\u2500\u2500 bd.sql            # Crea tablas y datos iniciales\r\n\u2502\r\n\u251c\u2500\u2500 default.conf          # Configuraci\xf3n de Nginx para PHP\r\n\u2502\r\n\u251c\u2500\u2500 docker-compose.yml    # Orquestaci\xf3n de contenedores\r\n\u2502\r\n\u2514\u2500\u2500 README.md             # Documentaci\xf3n del proyecto (opcional)\r\n\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"3-archivo-docker-composeyml",children:"3. Archivo docker-compose.yml"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"version: '3.9'\r\n\r\nservices:\r\n  php:\r\n    image: dark093/ultimoparcial:latest\r\n    container_name: gestor-php\r\n    environment:\r\n      DB_HOST: db\r\n      DB_PORT: 3306\r\n      DB_NAME: gestor\r\n      DB_USER: gestoruser\r\n      DB_PASS: gestorpass\r\n    networks:\r\n      - gestor_net\r\n    depends_on:\r\n      - db\r\n\r\n  nginx:\r\n    image: nginx:latest\r\n    container_name: gestor-nginx\r\n    ports:\r\n      - '8000:80'\r\n    volumes:\r\n      - ./default.conf:/etc/nginx/conf.d/default.conf:ro\r\n    networks:\r\n      - gestor_net\r\n    depends_on:\r\n      - php\r\n\r\n  db:\r\n    image: mariadb:latest\r\n    container_name: gestor-db\r\n    environment:\r\n      MYSQL_ROOT_PASSWORD: rootpass\r\n      MYSQL_DATABASE: gestor\r\n      MYSQL_USER: gestoruser\r\n      MYSQL_PASSWORD: gestorpass\r\n    volumes:\r\n      - db_data:/var/lib/mysql\r\n      - ./data/bd.sql:/docker-entrypoint-initdb.d/bd.sql\r\n    networks:\r\n      - gestor_net\r\n\r\n  phpmyadmin:\r\n    image: phpmyadmin:latest\r\n    container_name: gestor-pma\r\n    environment:\r\n      PMA_HOST: db\r\n      PMA_USER: gestoruser\r\n      PMA_PASSWORD: gestorpass\r\n    ports:\r\n      - '8081:80'\r\n    depends_on:\r\n      - db\r\n    networks:\r\n      - gestor_net\r\n\r\nnetworks:\r\n  gestor_net:\r\n\r\nvolumes:\r\n  db_data:\n"})}),"\n",(0,i.jsx)(n.h3,{id:"qu\xe9-hace-este-archivo",children:"\xbfQu\xe9 hace este archivo?"}),"\n",(0,i.jsx)(n.p,{children:"Define y levanta autom\xe1ticamente:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"PHP (aplicaci\xf3n principal)"}),"\n",(0,i.jsx)(n.li,{children:"Nginx (servidor web)"}),"\n",(0,i.jsx)(n.li,{children:"MariaDB (base de datos)"}),"\n",(0,i.jsx)(n.li,{children:"phpMyAdmin (administrador visual)"}),"\n",(0,i.jsx)(n.li,{children:"Redes internas"}),"\n",(0,i.jsx)(n.li,{children:"Vol\xfamenes persistentes"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"4-archivo-defaultconf-configuraci\xf3n-de-nginx",children:"4. Archivo default.conf (Configuraci\xf3n de Nginx)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:"server {\r\n    listen 80;\r\n    root /var/www/html;\r\n    index index.php index.html;\r\n\r\n    location / {\r\n        try_files $uri $uri/ /index.php?$query_string;\r\n    }\r\n\r\n    location ~ \\.php$ {\r\n        fastcgi_pass php:9000;\r\n        fastcgi_index index.php;\r\n        include fastcgi_params;\r\n        fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name;\r\n    }\r\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"5-archivo-de-base-de-datos-databdsql",children:"5. Archivo de Base de Datos (data/bd.sql)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Tabla usuarios\r\nCREATE TABLE usuarios (\r\n    id INT AUTO_INCREMENT PRIMARY KEY,\r\n    nombre VARCHAR(100) NOT NULL,\r\n    email VARCHAR(100) UNIQUE NOT NULL,\r\n    password_hash VARCHAR(255) NOT NULL,\r\n    rol ENUM('estudiante', 'admin') DEFAULT 'estudiante'\r\n);\r\n\r\n-- Tabla archivos\r\nCREATE TABLE archivos (\r\n    id INT AUTO_INCREMENT PRIMARY KEY,\r\n    nombre_original VARCHAR(255) NOT NULL,\r\n    guardado VARCHAR(255) NOT NULL,\r\n    fecha_subida DATETIME DEFAULT CURRENT_TIMESTAMP,\r\n    usuario_id INT NOT NULL,\r\n    FOREIGN KEY (usuario_id) REFERENCES usuarios(id)\r\n);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"credenciales-de-la-base-de-datos",children:"Credenciales de la base de datos"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Par\xe1metro"}),(0,i.jsx)(n.th,{children:"Valor"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Usuario"}),(0,i.jsx)(n.td,{children:"gestoruser"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Contrase\xf1a"}),(0,i.jsx)(n.td,{children:"gestorpass"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Base de datos"}),(0,i.jsx)(n.td,{children:"gestor"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"6-servicio-nginx--puertos",children:"6. Servicio Nginx \u2014 Puertos"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"nginx:\r\n  ports:\r\n    - '8000:80'\n"})}),"\n",(0,i.jsx)(n.p,{children:"El sitio estar\xe1 disponible en:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"http://localhost:8000",children:"http://localhost:8000"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"7-tabla-de-puertos-del-proyecto",children:"7. Tabla de Puertos del Proyecto"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Servicio"}),(0,i.jsx)(n.th,{children:"Host \u2192 Contenedor"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Nginx"}),(0,i.jsx)(n.td,{children:"8000 \u2192 80"}),(0,i.jsx)(n.td,{children:"Sitio web principal"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"phpMyAdmin"}),(0,i.jsx)(n.td,{children:"8081 \u2192 80"}),(0,i.jsx)(n.td,{children:"Administrar base de datos"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h1,{id:"8-comandos-de-despliegue",children:"8. Comandos de Despliegue"}),"\n",(0,i.jsx)(n.p,{children:"Estos comandos permiten descargar la imagen desde Docker Hub y levantar los servicios definidos."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"81-docker-pull-imagen",children:"8.1 docker pull imagen"}),"\n",(0,i.jsx)(n.p,{children:"Este comando descarga una imagen desde Docker Hub hacia tu m\xe1quina local."}),"\n",(0,i.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull usuario/mi-app:latest\n"})}),"\n",(0,i.jsx)(n.p,{children:"\xbfQu\xe9 hace?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Descarga la imagen desde Docker Hub"}),"\n",(0,i.jsx)(n.li,{children:"Obtiene la versi\xf3n m\xe1s reciente disponible"}),"\n",(0,i.jsx)(n.li,{children:"Actualiza la copia local para usarla en el despliegue"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"82-docker-compose-up--d",children:"8.2 docker-compose up -d"}),"\n",(0,i.jsxs)(n.p,{children:["Inicia todos los servicios definidos en ",(0,i.jsx)(n.code,{children:"docker-compose.yml"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d\n"})}),"\n",(0,i.jsx)(n.p,{children:"\xbfQu\xe9 hace?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Lee y ejecuta el archivo ",(0,i.jsx)(n.code,{children:"docker-compose.yml"})]}),"\n",(0,i.jsx)(n.li,{children:"Crea y levanta los contenedores del proyecto"}),"\n",(0,i.jsxs)(n.li,{children:["El par\xe1metro ",(0,i.jsx)(n.code,{children:"-d"})," ejecuta todo en segundo plano (detached mode)"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>o});var s=r(6540);const i={},a=s.createContext(i);function d(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);